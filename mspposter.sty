%% mspposter.sty
%% Copyright 2015 Alexander Hewer
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is Alexander Hewer, email: hewer@coli.uni-saarland.de
%
% This work consists of the file mspposter.sty

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{mspposter}

\RequirePackage{ifthen}
\RequirePackage{tikz}
% remove all margins
\RequirePackage[hmargin=0pt, vmargin=0pt, bindingoffset=0pt]{geometry}

\usetikzlibrary{
  calc,
  backgrounds,
  positioning,
  decorations.pathmorphing
}

\usepgfmodule{oo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% workaround for undefined control sequence error when 
% using tikzpicture inside a node
\newdimen\currentWidth
\newdimen\currentPadding

% class for poster
\pgfooclass{poster}{

  \method poster() {
  }

  % ATTRIBUTES

  \attribute topMargin=20;
  \attribute blockSpacing=20;
  \attribute blockOpen=false;
  \attribute columnAmount=1;
  \attribute currentColumn=1;
  \attribute blockWidth=\textwidth;
  \attribute oneColumnWidth=\textwidth; 
  \attribute twoColumnWidth=\textwidth; 
  \attribute threeColumnWidth=\textwidth; 
  \attribute fourColumnWidth=\textwidth; 
  \attribute blockPadding=10;

  % METHODS

  \method openBlockOneColumn(#1){
    \currentWidth = \pgfoovalueof{oneColumnWidth} pt
    \currentPadding = \pgfoovalueof{blockPadding} pt
    \node [
      below=\pgfoovalueof{blockSpacing}pt of center,
      text width=\currentWidth,
      #1,
      inner sep=\currentPadding,
      anchor=north]
      (current)
      \bgroup
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method openBlockTwoColumn(#1){
    \currentWidth = \pgfoovalueof{twoColumnWidth} pt
    \currentPadding = \pgfoovalueof{blockPadding} pt
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{1}}
    {
      \node [
        below=\pgfoovalueof{blockSpacing}pt of left,
        text width=\currentWidth,
        #1,
        inner sep=\currentPadding,
        anchor=north]
        (current)
      \bgroup
    }
    {
      \node [
        below=\pgfoovalueof{blockSpacing}pt of right,
        text width=\currentWidth,
        #1,
        inner sep=\currentPadding,
        anchor=north]
        (current)
      \bgroup
    }
  }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method openBlockThreeColumn(#1){
    \currentWidth = \pgfoovalueof{threeColumnWidth} pt
    \currentPadding = \pgfoovalueof{blockPadding} pt
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{1}}
    {
      \node [
        below=\pgfoovalueof{blockSpacing}pt of c3left,
        text width=\currentWidth,
        #1,
        inner sep=\currentPadding,
        anchor=north]
        (current)
      \bgroup
    }
    {%
      % else
    }%
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{2}}
    {
      \node [
        below=\pgfoovalueof{blockSpacing}pt of c3center,
        text width=\currentWidth,
        #1,
        inner sep=\currentPadding,
        anchor=north]
        (current)
      \bgroup
    }
    {%
      % else
    }%
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{3}}
    {
      \node [
        below=\pgfoovalueof{blockSpacing}pt of c3right,
        text width=\currentWidth,
        #1,
        inner sep=\currentPadding,
        anchor=north]
        (current)
      \bgroup
    }
    {%
      % else
    }%
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method openBlockFourColumn(#1){
    \currentWidth = \pgfoovalueof{fourColumnWidth} pt
    \currentPadding = \pgfoovalueof{blockPadding} pt
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{1}}
    {
      \node [
        below=\pgfoovalueof{blockSpacing}pt of c4left,
        text width=\currentWidth,
        #1,
        inner sep=\currentPadding,
        anchor=north]
        (current)
      \bgroup
    }
    {%
      % else
    }%
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{2}}
    {
      \node [
        below=\pgfoovalueof{blockSpacing}pt of c4halfleft,
        text width=\currentWidth,
        #1,
        inner sep=\currentPadding,
        anchor=north]
        (current)
      \bgroup
    }
    {%
      % else
    }%
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{3}}
    {
      \node [
        below=\pgfoovalueof{blockSpacing}pt of c4halfright,
        text width=\currentWidth,
        #1,
        inner sep=\currentPadding,
        anchor=north]
        (current)
      \bgroup
    }
    {%
      % else
    }%
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{4}}
    {
      \node [
        below=\pgfoovalueof{blockSpacing}pt of c4right,
        text width=\currentWidth,
        #1,
        inner sep=\currentPadding,
        anchor=north]
        (current)
      \bgroup
    }
    {%
      % else
    }%
  }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method openBlock(#1){%
    % try to close any open block
    \pgfoothis.closeBlock()
    % set flag to true
    \pgfooset{blockOpen}{true}
    % 
    \ifthenelse{\equal{\pgfoovalueof{columnAmount}}{1}}
    {
      \pgfoothis.openBlockOneColumn(#1)%
    }
    {%
      % else
    }%
    \ifthenelse{\equal{\pgfoovalueof{columnAmount}}{2}}
    {
      \pgfoothis.openBlockTwoColumn(#1)%
    }
    {%
      % else
    }%
    \ifthenelse{\equal{\pgfoovalueof{columnAmount}}{3}}
    {
      \pgfoothis.openBlockThreeColumn(#1)%
    }
    {%
      % else
    }%
    \ifthenelse{\equal{\pgfoovalueof{columnAmount}}{4}}
    {
      \pgfoothis.openBlockFourColumn(#1)%
    }
    {%
      % else
    }%
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method updateStateOneColumn(){
    % we only have one column, update all remaining anchors
    % two column
    \coordinate (left) at (current.south -| left); 
    \coordinate (right) at (current.south -| right); 
    % three column
    \coordinate (c3center) at (current.south -| c3center); 
    \coordinate (c3left) at (current.south -| c3left); 
    \coordinate (c3right) at (current.south -| c3right); 
    % four column
    \coordinate (c4left) at (current.south -| c4left); 
    \coordinate (c4halfleft) at (current.south -| c4halfleft); 
    \coordinate (c4halfright) at (current.south -| c4halfright); 
    \coordinate (c4right) at (current.south -| c4right); 
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method updateStateTwoColumn(){
    % we have two columns, check which is the current one
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{1}}
    {
      % update left anchor and move to next column
      \coordinate (left) at (current.south -| left); 
      \pgfooset{currentColumn}{2}
    }
    {
      % update right anchor and move to first column
      \pgfooset{currentColumn}{1}
      \coordinate (right) at (current.south -| right); 
    }
    % update anchors for three column layout
    \path let
      \p1 = (c3left),
      \p2 = (center) 
      in coordinate (c3left) at (\x1, \y2);
    \path let
      \p1 = (c3center),
      \p2 = (center) 
      in coordinate (c3center) at (\x1, \y2);
    \path let
      \p1 = (c3right),
      \p2 = (center) 
      in coordinate (c3right) at (\x1, \y2);
    % update anchors for four column layout
    \path let
      \p1 = (c4left),
      \p2 = (center) 
      in coordinate (c4left) at (\x1, \y2);
    \path let
      \p1 = (c4halfleft),
      \p2 = (center) 
      in coordinate (c4halfleft) at (\x1, \y2);
    \path let
      \p1 = (c4halfright),
      \p2 = (center) 
      in coordinate (c4halfright) at (\x1, \y2);
    \path let
      \p1 = (c4right),
      \p2 = (center) 
      in coordinate (c4right) at (\x1, \y2);
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method updateStateThreeColumn(){
    % we have three columns, check which is the current one
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{1}}
    {
      % update left anchor and move to next column
      \coordinate (c3left) at (current.south -| c3left); 
      \pgfooset{currentColumn}{2}
    }
    {
    % else
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{2}}
    {
       % update center anchor and move to next column
      \coordinate (c3center) at (current.south -| c3center); 
      \pgfooset{currentColumn}{3}
    }
    {
      % else
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{3}}
    {
      % update right anchor and move to first column
      \coordinate (c3right) at (current.south -| c3right); 
      \pgfooset{currentColumn}{1}
    }
    {
      % else
    }}}
    % update anchors for two column layout
    \path let
      \p1 = (left),
      \p2 = (center) 
      in coordinate (left) at (\x1, \y2);
    \path let
      \p1 = (right),
      \p2 = (center) 
      in coordinate (right) at (\x1, \y2);
    % update anchors for four column layout
    \path let
      \p1 = (c4left),
      \p2 = (center) 
      in coordinate (c4left) at (\x1, \y2);
    \path let
      \p1 = (c4halfleft),
      \p2 = (center) 
      in coordinate (c4halfleft) at (\x1, \y2);
    \path let
      \p1 = (c4halfright),
      \p2 = (center) 
      in coordinate (c4halfright) at (\x1, \y2);
    \path let
      \p1 = (c4right),
      \p2 = (center) 
      in coordinate (c4right) at (\x1, \y2);
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method updateStateFourColumn(){
    % we have three columns, check which is the current one
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{1}}
    {
      % update left anchor and move to next column
      \coordinate (c4left) at (current.south -| c4left); 
      \pgfooset{currentColumn}{2}
    }
    {
    % else
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{2}}
    {
       % update center anchor and move to next column
      \coordinate (c4halfleft) at (current.south -| c4halfleft); 
      \pgfooset{currentColumn}{3}
    }
    {
      % else
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{3}}
    {
      % update right anchor and move to first column
      \coordinate (c4halfright) at (current.south -| c4halfright); 
      \pgfooset{currentColumn}{4}
    }
    {
      % else
    \ifthenelse{\equal{\pgfoovalueof{currentColumn}}{4}}
    {
      % update right anchor and move to first column
      \coordinate (c4right) at (current.south -| c4right); 
      \pgfooset{currentColumn}{1}
    }
    {
      % else
    }}}}
    % update anchors for two column layout
    \path let
      \p1 = (left),
      \p2 = (center) 
      in coordinate (left) at (\x1, \y2);
    \path let
      \p1 = (right),
      \p2 = (center) 
      in coordinate (right) at (\x1, \y2);
    % update anchors for three column layout
    \path let
      \p1 = (c3left),
      \p2 = (center) 
      in coordinate (c3left) at (\x1, \y2);
    \path let
      \p1 = (c3center),
      \p2 = (center) 
      in coordinate (c3center) at (\x1, \y2);
    \path let
      \p1 = (c3right),
      \p2 = (center) 
      in coordinate (c3right) at (\x1, \y2);
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


  \method closeBlock(){
    % only close block if it is open
    \ifthenelse{\equal{\pgfoovalueof{blockOpen}}{true}}
    {%
      \egroup;
      % use path intersections to update coordinates
      % only update center if y value is smaller
      \path let
        \p1 = (center),
        \p2 = (current.south) 
        in \ifdim \y2 < \y1 coordinate (center) at (\x1, \y2)\fi;
      % set flag to false
      \pgfooset{blockOpen}{false}
      % update anchors and select next column
      \ifthenelse{\equal{\pgfoovalueof{columnAmount}}{1}}{
        \pgfoothis.updateStateOneColumn()
      }
      {
        % else
      }
      \ifthenelse{\equal{\pgfoovalueof{columnAmount}}{2}}
      {
        \pgfoothis.updateStateTwoColumn()
      }
      {
        % else
      }
      \ifthenelse{\equal{\pgfoovalueof{columnAmount}}{3}}
      {
        \pgfoothis.updateStateThreeColumn()
      }
      {
        % else
      }
      \ifthenelse{\equal{\pgfoovalueof{columnAmount}}{4}}
      {
        \pgfoothis.updateStateFourColumn()
      }
      {
        % else
      }
    }
    {
      % else
    }
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method updateLayout() {
    % set width of block in one column layout
    \pgfmathparse{ \textwidth - 2 * \pgfoovalueof{blockPadding}} 
    \pgfoolet{oneColumnWidth}{\pgfmathresult}
    % set width of block in two column layout
    \pgfmathparse{ (
          \textwidth
        - 4 * \pgfoovalueof{blockPadding}
        - \pgfoovalueof{blockSpacing}
      ) / 2
    } 
    \pgfoolet{twoColumnWidth}{\pgfmathresult}
    % set width of block in three column layout
    \pgfmathparse{ (
          \textwidth
        - 6 * \pgfoovalueof{blockPadding}
        - 2 * \pgfoovalueof{blockSpacing}
      ) / 3
    } 
    \pgfoolet{threeColumnWidth}{\pgfmathresult}
    % set width of block in four column layout
    \pgfmathparse{ (
          \textwidth
        - 8 * \pgfoovalueof{blockPadding}
        - 3 * \pgfoovalueof{blockSpacing}
      ) / 4
    } 
    \pgfoolet{fourColumnWidth}{\pgfmathresult}
    % setup anchors now, method uses twoColumnWidth, threeColumnWidth, and
    % fourColumnWidth
    \pgfoothis.setupAnchors()
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method setBlockPadding(#1) {
    \pgfooset{blockPadding}{#1}
    \pgfoothis.updateLayout()
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method setBlockSpacing(#1) {
    \pgfooset{blockSpacing}{#1}
    \pgfoothis.updateLayout()
    }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  % set amount of columns
  \method setColumns(#1) {
    % try to close any open block
    \pgfoothis.closeBlock()
    % set column amount 
    \pgfooset{columnAmount}{#1}
    % return to first column after change
    \pgfooset{currentColumn}{1}
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method setTopMargin(#1) {
    \pgfooset{topMargin}{#1}
    \pgfoothis.updateLayout()
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \method setupAnchors() {
    % initialize the anchors
    % compute y-coordinate for all anchors,
    % add blockSpacing to each y-coordinate, it is removed by the first block
    \pgfmathparse{ 0.5\paperheight + \pgfoovalueof{blockSpacing} - \pgfoovalueof{topMargin}}
    \coordinate (center) at (0, \pgfmathresult pt);
    % anchors for two column layout
    % align both anchors to create the wanted spacing between
    % two columns
    \coordinate (left) at  
      ( - 0.5 * \pgfoovalueof{blockSpacing}
        - \pgfoovalueof{blockPadding}
        - 0.5 * \pgfoovalueof{twoColumnWidth}
        - 0pt,
        \pgfmathresult pt
        );
    \coordinate (right) at 
    (     0.5 * \pgfoovalueof{blockSpacing}
        + \pgfoovalueof{blockPadding}
        + 0.5 * \pgfoovalueof{twoColumnWidth}
        + 0pt,
        \pgfmathresult pt
        );
    % anchors for three column layout
    % left
    \coordinate (c3left) at
    ( - 2 * \pgfoovalueof{blockPadding} 
      - \pgfoovalueof{threeColumnWidth} 
      - \pgfoovalueof{blockSpacing}
      - 0pt,
      \pgfmathresult pt
      );
    % center
    \coordinate (c3center) at (0, \pgfmathresult pt);
    % right
    \coordinate (c3right) at
    (   2 * \pgfoovalueof{blockPadding}
      + \pgfoovalueof{threeColumnWidth}
      + \pgfoovalueof{blockSpacing}
      + 0pt,
      \pgfmathresult pt
      );
    % anchors for four column layout
    % left
    \coordinate (c4left) at
    ( - 3   * \pgfoovalueof{blockPadding} 
      - 1.5 * \pgfoovalueof{fourColumnWidth} 
      - 1.5   * \pgfoovalueof{blockSpacing}
      - 0pt,
      \pgfmathresult pt
      );
    % half left
    \coordinate (c4halfleft) at
    ( - 1   * \pgfoovalueof{blockPadding} 
      - 0.5 * \pgfoovalueof{fourColumnWidth} 
      - 0.5   * \pgfoovalueof{blockSpacing}
      - 0pt,
      \pgfmathresult pt
      );
    % half right
    \coordinate (c4halfright) at
    (   1   * \pgfoovalueof{blockPadding} 
      + 0.5 * \pgfoovalueof{fourColumnWidth} 
      + 0.5   * \pgfoovalueof{blockSpacing}
      + 0pt,
      \pgfmathresult pt
      );
    % right
    \coordinate (c4right) at
    (   3   * \pgfoovalueof{blockPadding} 
      + 1.5 * \pgfoovalueof{fourColumnWidth} 
      + 1.5   * \pgfoovalueof{blockSpacing}
      + 0pt,
      \pgfmathresult pt
      );
  }
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create tikzpicture
\newenvironment{poster}{%
  % set width
  \textwidth0.9\paperwidth

  % create poster object
  \pgfoonew \poster=new poster()

  \parindent0pt
  % fill the whole page
  \begin{tikzpicture}
    \node[fill=white,
      anchor=north west,
      minimum width=\paperwidth,
      minimum height=\paperheight] {};
  \end{tikzpicture}%
  \begin{tikzpicture}[overlay,
      % shift origin of coordinate system
      shift={(-0.5\paperwidth,0.5\paperheight)},
      every node/.style={
        outer sep=0
      },
      % style for boxes
      box/.style={
        opacity=0.5,
        text opacity=1.0,
        fill=white,
        draw,
        ultra thick,
        rounded corners
      },
      logoboxbg/.style={
        align=center,
        minimum width=\paperwidth + 10pt,
        text width=\textwidth,
        fill=white,
        draw=black,
        ultra thick,
        decoration=random steps,
        decorate,
        inner sep=5
      }
  ]

  \poster.updateLayout()

  % for background shading
  \coordinate (bgleft) at (-.5\paperwidth,0);
  \coordinate (bgright) at (0.5\paperwidth,0);
  \coordinate (bottom) at (0,-.5\paperheight);
  \coordinate (upper) at (0,.5\paperheight);

  % background 
  \begin{scope}[on background layer]
    \shade [bottom color=red!30,top color=orange!40]
    (upper -|  bgleft) rectangle (bottom -| bgright);
  \end{scope}
}{%
  \poster.closeBlock()
  \end{tikzpicture}%
} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\setblockpadding}[1] {
  \poster.setBlockPadding(#1)
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\setblockspacing}[1] {
  \poster.setBlockSpacing(#1)
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\settopmargin}[1] {
  \poster.setTopMargin(#1)
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\shadebackground}[2] {
\begin{scope}[on background layer]
  \shade [bottom color=#1,top color=#2]
  (upper -|  bgleft) rectangle (bottom -| bgright);
\end{scope}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\setbackground}[1] {
  \begin{scope}[on background layer]
    \node[inner sep=0, anchor=north] at (upper) {
      #1
    };
  \end{scope}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{postercolumns}[1][1]{
  \poster.setColumns(#1)
}{
  \poster.setColumns(1)
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{posterblock}[1][box]{
  \poster.openBlock(#1)%
  % ignore leading white space
  \ignorespaces
  % place content inside a minipage
  \begin{minipage}{\textwidth}%
}
{%
  \end{minipage}%
  \poster.closeBlock()
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{posterblockH}[2][box]{
  \poster.openBlock(#1)%
  % ignore leading white space
  \ignorespaces
  % place content inside a minipage with fixed height
  \begin{minipage}[c][#2pt][t]{\textwidth}%
}
{%
  \end{minipage}%
  \poster.closeBlock()
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{logobox}[1][logoboxbg]{
  \begin{scope}[on background layer]
    \coordinate (logobox) at (0, -0.5\paperheight);
    % shift a little bit, such that the bottom border is not visible
    \node [#1, above=-4pt of logobox] \bgroup
    % ignore leading white space
    \ignorespaces
    % place content inside a minipage
    \begin{minipage}{\textwidth}%
}
{%
  \end{minipage}%
  \egroup;
  \end{scope}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
